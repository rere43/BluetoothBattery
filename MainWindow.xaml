<Window x:Class="BluetoothBattery2.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:local="clr-namespace:BluetoothBattery2.Wpf"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Bluetooth Battery" Width="310" MinWidth="300" SizeToContent="Height"
        Background="#050505" Foreground="White" WindowStartupLocation="Manual">
    <Window.Resources>
        <local:LogsConverter x:Key="LogsConverter" />
        <BooleanToVisibilityConverter x:Key="BoolToVisibility" />
        <SolidColorBrush x:Key="PageBackgroundBrush" Color="#050505" />
        <SolidColorBrush x:Key="CardBackgroundBrush" Color="#101010" />
        <SolidColorBrush x:Key="DividerBrush" Color="#1E1E1E" />
        <SolidColorBrush x:Key="SubTextBrush" Color="#8E8E93" />
        <SolidColorBrush x:Key="AccentBrush" Color="#2D9CFF" />
        <SolidColorBrush x:Key="LabelBrush" Color="#CFCFD6" />
        <SolidColorBrush x:Key="SpinnerButtonBackground" Color="#1E1E1E" />

        <!-- 标题字号：18 正文字号：14 -->
        <!-- 控件高度：18 下拉按钮宽度：24 下拉按钮1/2高度：9 操作按钮高度：28 -->
        <!-- 开关轨道高度：18 开关滑块高度：14 -->
        <!-- 帮助按钮大小：20 -->
        <sys:Double x:Key="TitleFontSize">18</sys:Double> <!-- 标题控件：标题字号 -->
        <sys:Double x:Key="BodyFontSize">14</sys:Double> <!-- 正文控件：正文字号 -->
        <sys:Double x:Key="ControlHeight">18</sys:Double> <!-- 基础控件：控件高度 -->
        <sys:Double x:Key="SpinnerButtonWidth">20</sys:Double> <!-- 数字框控件：下拉按钮宽度 -->
        <GridLength x:Key="SpinnerButtonGridWidth">20</GridLength> <!-- 网格列专用宽度，避免类型冲突 -->
        <sys:Double x:Key="SpinnerHalfHeight">9</sys:Double> <!-- 数字框控件：下拉按钮1/2高度 -->
        <sys:Double x:Key="ActionButtonHeight">28</sys:Double> <!-- 操作按钮控件：操作按钮高度 -->
        <sys:Double x:Key="SwitchTrackHeight">18</sys:Double> <!-- 开关控件：开关轨道高度 -->
        <sys:Double x:Key="SwitchTrackWidth">30</sys:Double> <!-- 开关控件：开关轨道宽度（约为正圆两倍） -->
        <sys:Double x:Key="SwitchThumbHeight">14</sys:Double> <!-- 开关控件：开关滑块高度（同宽形成正圆） -->
        <sys:Double x:Key="HelpButtonSize">20</sys:Double> <!-- 帮助按钮控件：帮助按钮大小 -->

        <!-- 统一使用的“减号”几何图形，供数字框与下拉按钮共享视觉 -->
        <Geometry x:Key="SpinnerMinusGeometry">M1,3 H7 V5 H1 Z</Geometry>
        <Style x:Key="SpinnerMinusPathStyle" TargetType="Path">
            <Setter Property="Data" Value="{StaticResource SpinnerMinusGeometry}" />
            <Setter Property="Fill" Value="White" />
            <Setter Property="Width" Value="8" />
            <Setter Property="Height" Value="2" />
            <Setter Property="Stretch" Value="Fill" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>
        <Geometry x:Key="SpinnerDownTriangleGeometry">M0,0 L8,0 L4,6 Z</Geometry>
        <Style x:Key="SpinnerDownTrianglePathStyle" TargetType="Path">
            <Setter Property="Data" Value="{StaticResource SpinnerDownTriangleGeometry}" />
            <Setter Property="Fill" Value="White" />
            <Setter Property="Width" Value="8" />
            <Setter Property="Height" Value="6" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style x:Key="SectionCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="8" />
            <Setter Property="Margin" Value="0,0,0,6" />
            <Setter Property="BorderBrush" Value="{StaticResource DividerBrush}" />
            <Setter Property="BorderThickness" Value="1" />
        </Style>

        <Style x:Key="SectionHeaderText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource TitleFontSize}" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Margin" Value="0 0 0 2" />
            <Setter Property="Foreground" Value="{StaticResource LabelBrush}" />
        </Style>

        <Style x:Key="SectionDescriptionText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource SubTextBrush}" />
            <Setter Property="FontSize" Value="{StaticResource BodyFontSize}" />
            <Setter Property="Margin" Value="0 0 0 3" />
        </Style>

        <Style x:Key="SettingLabelText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource LabelBrush}" />
            <Setter Property="FontSize" Value="{StaticResource BodyFontSize}" />
        </Style>

        <!-- 数字/文本输入共用样式（含圆角） -->
        <Style x:Key="SettingTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#181818" />
            <Setter Property="BorderBrush" Value="#2A2A2A" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="4,0" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="Height" Value="{StaticResource ControlHeight}" />
            <Setter Property="FontSize" Value="{StaticResource BodyFontSize}" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="TextAlignment" Value="Right" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ScrollViewer x:Name="PART_ContentHost" Background="Transparent" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 自定义细窄滚动条：自动隐藏、透明背景、圆角指示条 -->
        <Style x:Key="MinimalScrollBarStyle" TargetType="ScrollBar">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Width" Value="6" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Track x:Name="PART_Track" IsDirectionReversed="true">
                            <Track.DecreaseRepeatButton>
                                <RepeatButton Height="0" Width="0" />
                            </Track.DecreaseRepeatButton>
                            <Track.Thumb>
                                <Thumb>
                                    <Thumb.Template>
                                        <ControlTemplate TargetType="Thumb">
                                            <Border Background="#3A3A3A" CornerRadius="3" />
                                        </ControlTemplate>
                                    </Thumb.Template>
                                </Thumb>
                            </Track.Thumb>
                            <Track.IncreaseRepeatButton>
                                <RepeatButton Height="0" Width="0" />
                            </Track.IncreaseRepeatButton>
                        </Track>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MinimalScrollViewerStyle" TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <ScrollContentPresenter Grid.Column="0" Grid.Row="0" />
                            <ScrollBar x:Name="PART_VerticalScrollBar" Grid.Column="1" Grid.Row="0" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                       Style="{StaticResource MinimalScrollBarStyle}" Orientation="Vertical" />
                            <ScrollBar x:Name="PART_HorizontalScrollBar" Grid.Column="0" Grid.Row="1" Visibility="Hidden" Orientation="Horizontal" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <ControlTemplate x:Key="ComboBoxTemplateLeft" TargetType="ComboBox">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="{StaticResource SpinnerButtonGridWidth}" />
                </Grid.ColumnDefinitions>
                <Border Grid.Column="0" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="4" Padding="4,0" Height="{StaticResource ControlHeight}"
                        MouseLeftButtonDown="ComboBoxContentBorder_MouseLeftButtonDown">
                    <ContentPresenter Margin="0" VerticalAlignment="Center"
                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                      RecognizesAccessKey="True"
                                      Content="{TemplateBinding SelectionBoxItem}" TextElement.Foreground="{TemplateBinding Foreground}" />
                </Border>
                <ToggleButton x:Name="ToggleButton" Grid.Column="1" Background="{StaticResource SpinnerButtonBackground}" BorderThickness="0"
                              Focusable="False" Padding="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                              Height="{StaticResource ControlHeight}" Width="{StaticResource SpinnerButtonWidth}"
                              IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                    <Path Style="{StaticResource SpinnerDownTrianglePathStyle}" />
                </ToggleButton>
                <Popup x:Name="PART_Popup" Placement="Bottom"
                       PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                       Width="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}"
                       IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False">
                    <Border Background="#181818" BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="10" Padding="4"
                            Width="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}">
                        <ScrollViewer Style="{StaticResource MinimalScrollViewerStyle}" CanContentScroll="True">
                            <StackPanel IsItemsHost="True" TextElement.Foreground="{TemplateBinding Foreground}" />
                        </ScrollViewer>
                    </Border>
                </Popup>
            </Grid>
        </ControlTemplate>

        <!-- 下拉框套用与数字框一致的视觉 -->
        <Style x:Key="SettingComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#181818" />
            <Setter Property="BorderBrush" Value="#2A2A2A" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="2,0" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Height" Value="{StaticResource ControlHeight}" />
            <Setter Property="FontSize" Value="{StaticResource BodyFontSize}" />
            <Setter Property="Template" Value="{StaticResource ComboBoxTemplateLeft}" />
        </Style>

        <Style x:Key="RightAlignedComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource SettingComboBoxStyle}">
            <Setter Property="HorizontalContentAlignment" Value="Right" />
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="HorizontalContentAlignment" Value="Left" />
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentBrush}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="Padding" Value="8 4" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="{StaticResource BodyFontSize}" />
            <Setter Property="MinHeight" Value="{StaticResource ActionButtonHeight}" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="12"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                              Content="{TemplateBinding Content}">
                                <ContentPresenter.Effect>
                                    <DropShadowEffect Color="#AA000000" BlurRadius="8" ShadowDepth="0" Opacity="0.7" />
                                </ContentPresenter.Effect>
                            </ContentPresenter>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
            <Setter Property="Background" Value="{StaticResource SpinnerButtonBackground}" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <Style x:Key="SwitchStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource LabelBrush}" />
            <Setter Property="FontSize" Value="{StaticResource BodyFontSize}" />
            <Setter Property="MinHeight" Value="{StaticResource ControlHeight}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <ContentPresenter VerticalAlignment="Center" />
                            <!-- Toggle 轨道同样通过 SwitchTrackHeight 资源限制整体高度，宽度固定避免亮起时尺寸变化 -->
                            <Border x:Name="Track" Grid.Column="1" Width="{StaticResource SwitchTrackWidth}" Height="{StaticResource SwitchTrackHeight}" CornerRadius="9" Margin="12 0 0 0"
                                    Background="#2A2A2A">
                                <Border x:Name="Thumb" Width="{StaticResource SwitchThumbHeight}" Height="{StaticResource SwitchThumbHeight}" CornerRadius="7" Background="White"
                                        Margin="2" HorizontalAlignment="Left" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Thumb" Property="HorizontalAlignment" Value="Right" />
                                <Setter TargetName="Thumb" Property="Background" Value="White" />
                                <Setter TargetName="Track" Property="Background" Value="{StaticResource AccentBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SpinnerButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#1E1E1E" />
            <Setter Property="BorderBrush" Value="#2A2A2A" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Width" Value="{StaticResource SpinnerButtonWidth}" />
            <Setter Property="Height" Value="{StaticResource SpinnerHalfHeight}" />
            <Setter Property="MinHeight" Value="{StaticResource SpinnerHalfHeight}" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

        <!-- 主内容区域 + 右上角帮助按钮（移除滚动条避免高度跳变） -->
    <Grid Background="{StaticResource PageBackgroundBrush}" MouseLeftButtonDown="WindowRoot_OnMouseLeftButtonDown">
        <StackPanel Margin="3" Grid.IsSharedSizeScope="True">
                <!-- 设备列表卡片 -->
                <Border Style="{StaticResource SectionCard}">
                    <StackPanel>
                        <!-- 使用共享列宽包裹控件，保证与其他设置项左右对齐 -->
                        <Grid Margin="0,2,0,2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="SettingLabelColumn" />
                                <ColumnDefinition Width="*" SharedSizeGroup="SettingValueColumn" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{Binding DeviceSelectionHint}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <ComboBox Grid.Column="1" ItemsSource="{Binding AvailableDevices}" Style="{StaticResource SettingComboBoxStyle}"
                                      SelectedItem="{Binding SelectedDevice, Mode=TwoWay}" />
                        </Grid>
                        <Button Margin="0,2,0,0" Content="{Binding RefreshDevicesButtonText}" Style="{StaticResource PrimaryButtonStyle}"
                                Width="160" HorizontalAlignment="Center" Command="{Binding RefreshDevicesCommand}" />
                    </StackPanel>
                </Border>

                <!-- 刷新/字体设置 -->
                <Border Style="{StaticResource SectionCard}">
                    <StackPanel>
                        <Grid Margin="0,2,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="SettingLabelColumn" />
                                <ColumnDefinition Width="*" SharedSizeGroup="SettingValueColumn" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Text="{Binding RefreshIntervalLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <Grid Grid.Column="1" Margin="6 0 0 2" Grid.ColumnSpan="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="{StaticResource SpinnerButtonGridWidth}" />
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="RefreshIntervalTextBox" Style="{StaticResource SettingTextBoxStyle}"
                                         Text="{Binding RefreshInterval, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericTextBox_PreviewTextInput"
                                         PreviewMouseWheel="NumericTextBox_PreviewMouseWheel" />
                                <StackPanel Grid.Column="1" Orientation="Vertical">
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=RefreshIntervalTextBox}" CommandParameter="1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Data="M4,0 L8,6 L0,6 Z" Fill="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Button>
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=RefreshIntervalTextBox}" CommandParameter="-1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Style="{StaticResource SpinnerDownTrianglePathStyle}" />
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <TextBlock Grid.Row="1" Text="{Binding FontLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <ComboBox Grid.Column="1" Grid.Row="1" Style="{StaticResource RightAlignedComboBoxStyle}" Margin="6 2 0 2"
                                      ItemsSource="{Binding FontFamilies}"
                                      SelectedItem="{Binding SelectedFontFamily, Mode=TwoWay}" />

                            <TextBlock Grid.Row="2" Text="{Binding LanguageLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <ComboBox Grid.Column="1" Grid.Row="2" Style="{StaticResource RightAlignedComboBoxStyle}" Margin="6 2 0 2"
                                      ItemsSource="{Binding Languages}" SelectedItem="{Binding SelectedLanguage, Mode=TwoWay}" DisplayMemberPath="Display" />

                            <TextBlock Grid.Row="3" Text="{Binding BatteryModeLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <ComboBox Grid.Column="1" Grid.Row="3" Style="{StaticResource RightAlignedComboBoxStyle}" Margin="6 2 0 0"
                                      ItemsSource="{Binding BatteryModeOptions}" SelectedItem="{Binding SelectedBatteryMode, Mode=TwoWay}" />
                        </Grid>

                        <StackPanel Margin="0,4,0,0">
                            <CheckBox Content="{Binding RunOnStartupLabelText}" IsChecked="{Binding RunOnStartup}" Style="{StaticResource SwitchStyle}" Margin="0,0,0,3" />
                            <CheckBox Content="{Binding CloseButtonMinimizeLabelText}" IsChecked="{Binding IsCloseButtonMinimize}" Style="{StaticResource SwitchStyle}" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 图标布局设置 -->
                <Border Style="{StaticResource SectionCard}">
                    <StackPanel>
                        <Grid Margin="0,3,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="SettingLabelColumn" />
                                <ColumnDefinition Width="*" SharedSizeGroup="SettingValueColumn" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Text="{Binding IconOffsetXLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <Grid Grid.Column="1" Margin="6 0 0 3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="{StaticResource SpinnerButtonGridWidth}" />
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="IconOffsetXTextBox" Style="{StaticResource SettingTextBoxStyle}" Tag="signed"
                                         Text="{Binding IconOffsetX, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericTextBox_PreviewTextInput"
                                         PreviewMouseWheel="NumericTextBox_PreviewMouseWheel" />
                                <StackPanel Grid.Column="1" Orientation="Vertical" Margin="2,0,0,0">
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=IconOffsetXTextBox}" CommandParameter="1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Data="M4,0 L8,6 L0,6 Z" Fill="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Button>
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=IconOffsetXTextBox}" CommandParameter="-1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Style="{StaticResource SpinnerDownTrianglePathStyle}" />
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <TextBlock Grid.Row="1" Text="{Binding IconOffsetYLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <Grid Grid.Column="1" Grid.Row="1" Margin="6 0 0 3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="{StaticResource SpinnerButtonGridWidth}" />
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="IconOffsetYTextBox" Style="{StaticResource SettingTextBoxStyle}" Tag="signed"
                                         Text="{Binding IconOffsetY, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericTextBox_PreviewTextInput"
                                         PreviewMouseWheel="NumericTextBox_PreviewMouseWheel" />
                                <StackPanel Grid.Column="1" Orientation="Vertical" Margin="2,0,0,0">
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=IconOffsetYTextBox}" CommandParameter="1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Data="M4,0 L8,6 L0,6 Z" Fill="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Button>
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=IconOffsetYTextBox}" CommandParameter="-1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Style="{StaticResource SpinnerDownTrianglePathStyle}" />
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <TextBlock Grid.Row="2" Text="{Binding IconFontSizeLabelText}" Style="{StaticResource SettingLabelText}" VerticalAlignment="Center" />
                            <Grid Grid.Column="1" Grid.Row="2" Margin="6 0 0 0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="{StaticResource SpinnerButtonGridWidth}" />
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="IconFontSizeTextBox" Style="{StaticResource SettingTextBoxStyle}" Tag="signed"
                                         Text="{Binding IconFontSize, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericTextBox_PreviewTextInput"
                                         PreviewMouseWheel="NumericTextBox_PreviewMouseWheel" />
                                <StackPanel Grid.Column="1" Orientation="Vertical" Margin="2,0,0,0">
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=IconFontSizeTextBox}" CommandParameter="1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Data="M4,0 L8,6 L0,6 Z" Fill="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Button>
                                    <Button Style="{StaticResource SpinnerButtonStyle}" Tag="{Binding ElementName=IconFontSizeTextBox}" CommandParameter="-1"
                                            Click="NumericSpinnerButton_Click">
                                        <Path Style="{StaticResource SpinnerDownTrianglePathStyle}" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- 操作按钮区域 -->
                <Border Style="{StaticResource SectionCard}">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="{Binding SaveButtonText}" Style="{StaticResource PrimaryButtonStyle}" Width="96"
                                Command="{Binding SaveCommand}" />
                        <Button Content="{Binding ResetButtonText}" Style="{StaticResource SecondaryButtonStyle}" Width="96"
                                Command="{Binding ResetCommand}" Margin="6,0,0,0" />
                    </StackPanel>
                </Border>

                <!-- Status -->
                <Border Style="{StaticResource SectionCard}" Background="#0A0A0A">
                    <StackPanel>
                        <TextBlock Text="{Binding StatusMessage}" TextWrapping="Wrap" Foreground="#A6F08D" FontSize="{StaticResource BodyFontSize}" />
                    </StackPanel>
                </Border>

                <!-- Refresh Logs -->
                <Border Style="{StaticResource SectionCard}" Background="#0A0A0A">
                    <StackPanel>
                        <DockPanel Margin="0 0 0 2">
                            <TextBlock Text="{Binding RefreshLogLabelText}"
                                       Style="{StaticResource SectionHeaderText}"
                                       DockPanel.Dock="Left"
                                       Visibility="{Binding IsRefreshLogEnabled, Converter={StaticResource BoolToVisibility}}" />
                            <Button Content="{Binding RefreshLogToggleButtonText}"
                                    Command="{Binding ToggleLogsCommand}"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    HorizontalAlignment="Right"
                                    Margin="8,0,0,0"
                                    Width="110" />
                        </DockPanel>
                        <TextBox Text="{Binding RefreshLogText, Mode=OneWay}"
                                 IsReadOnly="True"
                                 AcceptsReturn="True"
                                 TextWrapping="NoWrap"
                                 VerticalScrollBarVisibility="Auto"
                                 Height="100"
                                 FontFamily="Consolas"
                                 FontSize="11"
                                 Foreground="#CCC"
                                 Background="#111"
                                 BorderThickness="1"
                                 BorderBrush="#2A2A2A"
                                 Visibility="{Binding IsRefreshLogEnabled, Converter={StaticResource BoolToVisibility}}">
                            <TextBox.Resources>
                                <Style TargetType="ScrollBar" BasedOn="{StaticResource MinimalScrollBarStyle}" />
                            </TextBox.Resources>
                        </TextBox>
                    </StackPanel>
                </Border>
            </StackPanel>
        <Button Width="{StaticResource HelpButtonSize}" Height="{StaticResource HelpButtonSize}" Click="HelpButton_Click" ToolTip="{Binding HelpPrompt}"
                HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,3,3,0"
                Background="Transparent" BorderThickness="0" Padding="0" Foreground="White">
            <TextBlock Text="?" FontSize="{StaticResource TitleFontSize}" FontWeight="Bold" />
        </Button>
    </Grid>
</Window>
