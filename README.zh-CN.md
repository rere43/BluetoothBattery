# BluetoothBattery2

一个在系统托盘显示蓝牙设备电量的 Windows 小工具。

---

## 功能简介

- 显示指定蓝牙设备的电量（托盘图标数字）
- 支持自定义字体、图标偏移与字号
- 支持中英文界面切换
- 定时刷新电量信息

---

## 界面说明

- **设备名**  
  从下拉框选择要监控电量的蓝牙设备。

- **刷新间隔 (毫秒)**  
  刷新间隔，单位毫秒。小于 `1000` 时会自动乘以 `1000` 转为秒级。

- **字体 family**  
  用于托盘数字绘制的字体。

- **点击关闭按钮时最小化到托盘**  
  勾选后点击关闭按钮不会退出程序，只隐藏到托盘。

- **图标布局设置**  
  - `X偏移`
  - `Y偏移`
  - `字号偏移`

  点击“应用”按钮预览效果。弹出的对话框中：
  - 选择“是”：写入配置并重建图标缓存；
  - 选择“否”：仅预览本次效果，恢复之前的偏移和字号。

- **语言**  
  下拉选择：
  - `中文`
  - `英文`

---

## 使用方法

1. 点击右侧的“刷新”按钮，等待设备名标签恢复为“设备名”。
2. 在第一个下拉框中选择蓝牙设备。
3. 在刷新间隔文本框中设置刷新间隔（建议不要过低，默认 600 秒）。
4. 根据需要选择字体和图标布局。
5. 点击“保存并刷新”应用设置。

托盘图标会显示当前电量（1–99）。

- 鼠标移动到图标上会显示提示信息，包括：
  - 设备名称
  - 电量
  - 距离上次刷新时间
  - 刷新间隔
  - 字体名称
- 双击托盘图标显示/隐藏主窗口。

---

## 语言设置

- 语言设置会被保存到 `settings.txt` 中。
- 下次启动时会自动使用上次选择的语言。
- 界面文案、消息弹窗、托盘提示文本都会根据当前语言切换。

---

## 注意事项

- 本工具依赖 PowerShell `Get-PnpDevice` 等命令获取蓝牙设备电量，仅在支持该接口的系统上有效。
- 当前目标框架为 `net6.0-windows`，在较新的 .NET SDK 上会收到已停止支持的警告，建议后续升级。
